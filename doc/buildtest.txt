"fftMPI documentation"_Manual.html

Building the test programs :h3

The test directory has several programs that illustrate how to use
fftMPI.  They can also be used to benchmark its performance.  These
files invoke 3d FFTs.

test3d.cpp : use fftMPI as a C++ class
test3d_c.c : use fftMPI thru its C interface
test3d_f90.f90 : use fftMPI thru its Fortran interface 
test3d.py : use fftMPI thru its Python interface :ul

Likewise for the test2d* files which invoke 2d FFTs.

You can build all the test programs (apps) from the test directory, by
typing:

% make :pre

The resulting executables are

C++: test3d and test2d
C: test3d_c and test2d_c
F90: test3d_f90 and test2d_f90
Python: test3d.py (no build necessary) :ul

The standard Makefile uses mpicxx for compiling and linking the C++
and C programs, and mpifort for the Fortran 90 programs, using
whatever C++ and Fortran compilers they wrap.  If your MPI
installation does not include Fortran support, then you will not have
an mpifort and the Fortran test programs will not build.

There are also a few provided Makefile.machine files that work on
different supercomputers.  You can use one of them or create your own
edited file and invoke it as

% make -f Makefile.machine :pre

You should only need to edit the "compiler/linker settings" section at
the top of any Makefile.machine.

:line

As with the "fftMPI library build"_compile.html, there are 2 options
for precision and a choice of 1d FFT library, that can be set in the
make command, via the "p" and "fft" variables.  You can set either or
both variables in a single make command:

% make p=single            # single precision, p=double is default
% make fft=fftw            # use the FFTW3 lib for 1d FFTs
                           # options: fftw, fftw3, fftw2, mkl, kiss (default)
% make test2d p=single     # build just the C++ test2d app
% make test3d_f90 fft=mkl  # build just the Fortran test3d app
% make help                # see syntax for all options

The fftw setting is the same as fftw3.

IMPORTANT NOTE: You must use the same values for the "p" and "fft"
variables as were used when building the fftMPI library in the src
directory.  For the "p" variable this insures the single- or
double-precision data types used in the calling program for the FFT
grid data match what the library uses.  For the "fft" variable this
insures the calling program links to the appropriate 1d FFT library,
e.g. FFTW2 or MKL.  If you do not use the same variable settings,
compile-time errors or a run-time error message will be generated.
See additional comments on the "Using the library from your
program"_#usage.html doc page for how to insure this consistency when
using the library from your program.

The Makefile has two variables FFT_INC and FFT_PATH which point to the
fftMPI src dir.  This is so the test apps can find the fftMPI header
files and library files created when you compiled fftMPI.  If you use
fftMPI from your own program, built in another location, you will need
to either install fftMPI in a standard place (e.g. under /usr/local),
or you will need settings like for these variables to point to your
fftMPI src directory.

The Makefile also assumes the library file for the 1d FFT library you
select is in your LD_LIBRARY_PATH, as defined in your environment, so
that it can link to the library correctly.  These libraries are
as follows:

FFTW2: libfftw.a
FFTW3 double precision: libfftw3.a
FFTW3 single precision: libfftw3f.a
MKL built with Intel compiler: libmkl_intel_lp64.a, libmkl_sequential.a, libmkl_core.a 
MKL built with GNU compiler: libmkl_gf_lp64.a, libmkl_sequential.a, libmkl_core.a
KISS: only an include file (no library file) :ul

If the appropriate library file is not found, you will need to add a
setting for the its directory to FFT_PATH in the Makefile, something
like -L/home/me/pathforMKL/lib.

You can also use shared library (*.so) versions of these files.  This
requires that those files exist on your system (e.g. you built FFTW as
a shared library) and that your system can find those files at run
time to load them.  This requires that your LD_LIBRARY_PATH
environment variable includes the path for these 1d FFT libraries.
See the "usage"_usage.html doc page for details on how to augment the
LD_LIBRARY_PATH variable if needed with new directories.
